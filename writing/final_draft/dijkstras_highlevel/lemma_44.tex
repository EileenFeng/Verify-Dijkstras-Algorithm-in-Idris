%================================================================================================
% Lemma 4.4
%================================================================================================
\begin{sublemma}\label{lemma4.4}
For any node $v \in g$, for $n \geq 1$, for all $u_i$ during the $i^{th}$ iteration for some $1 \leq i \leq n$ ($u_i \in explored_{n+1}$), $dist_{n+1}[v] \leq dist_i[u_i] + weight(u_i, v)$. 
\end{sublemma}
\begin{proof}
We will prove Lemma 4.4 by inducting on the number $n$. 
\\
Let P(n) be: for any node $v \in g$, for each $u_i \in explored_{n+1}$, $n \geq 1, 1 \leq i \leq n$, $dist_{n+1}[v] \leq dist_i[u_i] + weight(u_i, v)$. 
\\
\textbf{Base Case}: We shall show P(1) holds. 
\\
Based on the algorithm, $dist_1[s] = 0$, and for all node $v \in g$ other than $s$, $dist_1[v] = \infty$, and $explored_2$ only contains $s$. For node $s$, $dist_2[s] = 0 \leq dist_1[s] + weight(s, s) = 0$. For all node $v \in g$ other than $s$, we have: 
\begin{align*}
      dist_2[v] &= min(dist_1[v], dist_1[s] + weight(s, v)) \\
                &\leq dist_1[s] + weight(s, v)
\end{align*}
Since $s$ is the only node in $explored_2$, then the above equation directly shows that P(1) holds. 
\\\\
\textbf{Induction Hypothesis}: Suppose P(k) holds for $k > 1$. That is, for any node $v \in g$, for each $u_i \in explored_{k+1}$, $k > 1, 1 \leq i \leq k$, $dist_{k+1}[v] \leq dist_i[u_i] + weight(u_i, v)$. 
\\\\
\textbf{Inductive Step}: we shall show P(k+1) holds. That is,  for $k+1 > 1$, forall nodes $v \in g$,  for each $u_i \in explored_{k+2}$, $k > 1, 1 \leq i \leq k+1$, $dist_{k+2}[v] \leq dist_i[u_i] + weight(u_i, v)$. 
\\
Suppose $u_{k+1}$ is the node being explored during the $(k+1)^{th}$ iteration, then $explored_{k+2} = explored_{k+1} \cup \{u_{k+1}\}$. Forall node $v \in g$, we have: 
\begin{align*}
  dist_{k+2}[v] = min(dist_{k+1}[v], dist_{k+1}[u_{k+1}] + weight(u_{k+1}, v))
\end{align*}
Hence we have: 
\begin{align*}
  dist_{k+2}[v] &\leq dist_{k+1}[v] ([E4.4.1])\\
  dist_{k+2} &\leq dist_{k+1}[u_{k+1}] + weight(u_{k+1}, v)([E4.4.2])
\end{align*}
The induction hypothesis implies that $dist_{k+1}[v] \leq dist_i[u_i] + weight(u_i, v), \forall u_i \in explored_{k+1}$. Combining with [E4.4.1], we have: 
\begin{align*}
dist_{k+2}[v] \leq dist_i[u_i] + weight(u_i, v), \forall u_i \in explored_{k+1} [E4.4.3]
\end{align*}
Since $explored_{k+2} = explored_{k+1} \cup \{u_{k+1}\}$, then equation [E4.4.2] and equation [E4.4.3] implies that $dist_{k+2}[v] \leq dist_i[u_i] + weight(u_i, v), \forall u_i \in explored_{k+1} \cup \{u_{k+1}\} = explored_{k+2}$. P(k+1) holds. By the principle of prove by induction, P(n) holds. \texttt{Lemma 4.4} proved. 
\end{proof}
\tab\\